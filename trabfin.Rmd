---
output:
  html_document: default
  pdf_document: default
  word_document: default
---

<head>

```{=html}
<style>
    h1{
    text-align: center;
    color:lightblue
    }
    p{text-align: justify;
    font-size:17px;
    text-indent: 2em;
    }
    td{
    font-size: 17px
    }
    div.imag {
      margin-left: auto;
      margin-right: auto;
      width: 38%;
      transform: scale(1.15);
    }
    div.imag_2 {
      margin-left: auto;
      margin-right: auto;
      width: 27%;
    }
    div.imag_1 {
      margin-left: auto;
      margin-right: auto;
      width: 50%;
      padding: 50px;
      transform: scale(2.0);
    }

    div.imag_3 {
      margin-left: auto;
      margin-right: auto;
      width: 50%;
      padding: 50px;
      transform: scale(1.5);
    }
    p.leg{
      text-align: left;
      width:210px; 
      border: 0px solid black; 
      margin: 0 auto;
    }
    p.legenda_1{
      text-align: left;
      width: 235px; 
      border: 0px solid black; 
      margin: 0 auto;
    }

    div.histor {
      margin-left: auto;
      margin-right: auto;
      width:65%;
    }
     div.cent {
      margin-left: auto;
      margin-right: auto;
      width:75%;
      
    }
    div.histor_1 {
      margin-left: auto;
      margin-right: auto;
      width:65%;
      transform: scale(1.1);
    }
    div.remove pre{
    display: none;
    }
    div.histor pre{
    display: none;
    }
    div.abaixar{
    aling:center;
    }
    div.diminuir{
     aling:center;
    
    }

  </style>
```

</head>
```{r setup, include=FALSE, echo=FALSE}
library(DescTools)
library(ggplot2)
library(flextable)
library(descr)

#Importar os ficheiros do Excel
Sys.setlocale("LC_ALL", "Portuguese_Portugal.UTF-8")
library(openxlsx)
bd <- read.xlsx("Trabalho_ecell.xlsx")
#Mudar o nome de duas variáveis Variáveis da base de dados
colnames(bd)
names(bd)[4] = "valor_genero"
names(bd)[9] = "satisfacao_vida"
paste("Existem",sum(bd$satisfacao_vida == 99),"valores omissos")
media_antes <- mean(bd$satisfacao_vida)

n_amostra <- nrow(bd)
print(n_amostra)

bd$satisfacao_vida[bd$satisfacao_vida == 99] <- NA
bd$satisfacao_vida[is.na(bd$satisfacao_vida)] <- median(bd$satisfacao_vida, na.rm = TRUE)
media_depois <- mean(bd$satisfacao_vida)
paste("Média antes de inputar os valores omissos:",round(media_antes,2),"\n Média depois de inputar os valores omissos com mediana", round(media_depois,2))

#Lidar com os valores omissos das outras variaveis
bd$v38_ansiedade[bd$v38_ansiedade == 99] <- NA
bd$v38_ansiedade[is.na(bd$v38_ansiedade)] <- median(bd$v38_ansiedade, na.rm = TRUE)
bd$v40_ansiedade[bd$v40_ansiedade == 99] <- NA
bd$v40_ansiedade[is.na(bd$v40_ansiedade)] <- median(bd$v40_ansiedade, na.rm = TRUE)
bd$v43_ansiedade[bd$v43_ansiedade == 99] <- NA
bd$v43_ansiedade[is.na(bd$v43_ansiedade)] <- median(bd$v43_ansiedade, na.rm = TRUE)
bd$v45_ansiedade[bd$v45_ansiedade == 99] <- NA
bd$v45_ansiedade[is.na(bd$v45_ansiedade)] <- median(bd$v45_ansiedade, na.rm = TRUE)
bd$v51_ansiedade[bd$v51_ansiedade == 99] <- NA
bd$v51_ansiedade[is.na(bd$v51_ansiedade)] <- median(bd$v51_ansiedade, na.rm = TRUE)
bd$v55_ansiedade[bd$v55_ansiedade == 99] <- NA
bd$v55_ansiedade[is.na(bd$v55_ansiedade)] <- median(bd$v55_ansiedade, na.rm = TRUE)
bd$v56_ansiedade[bd$v56_ansiedade == 99] <- NA
bd$v56_ansiedade[is.na(bd$v56_ansiedade)] <- median(bd$v56_ansiedade, na.rm = TRUE)
bd$AF_Q554[bd$AF_Q554 == 99] <- NA
bd$AF_Q554[is.na(bd$AF_Q554)] <- median(bd$AF_Q554, na.rm = TRUE)
```

<body>

::: {.imag style="text-align:center"}
![](https://mostra.caerus.pt/wp-content/uploads/2021/04/ISCTE_Logo.png)
:::
<hr>

<h1 style="font-size: 40px;">**RELATÓRIO - CASO PRÁTICO - AMBIENTE 10**</h1>


<p style="text-align:center;font-size: 15px;">Março de 2025</p>


</h1>

<p style="text-align:center;font-size: 15px;">

Março de 2025

</p>
<br>

<h4>Trabalho realizado por:</h4>

<ul>

<td>Leandro Bernardo, nº 125293</td>
<br>
<td>Paula Relvas, nº 43905</td>
<br>
<td>Pedro Gonçalves, nº 130668</td>
<br>
<td>Ricardo Fonseca, nº 130650</td>
<br>
<td>Tiago Oeber, nº 130667</td>
<br>

O presente documento foi construído para a Unidade Curricular Análise de Exploratória de Dados, da Licenciatura em Ciência de Dados do Iscte-IUL.

<br>

</ul>

<h3>**INTRODUÇÃO**</h3>

<br>

<p>A ansiedade e o bem-estar emocional constituem dois pilares essenciais para a compreensão da saúde mental. A ansiedade, enquanto resposta natural do organismo a situações de stress ou perigo, manifesta-se através de sentimentos de preocupação, medo e tensão. Embora essa reação seja intrínseca à nossa natureza, ela pode tornar-se prejudicial quando se intensifica de forma excessiva ou persistente, afetando o quotidiano e o funcionamento psicológico do indivíduo. <br>

A ansiedade e o bem-estar emocional constituem dois pilares essenciais para a compreensão da saúde mental. A ansiedade, enquanto resposta natural do organismo a situações de stress ou perigo, manifesta-se através de sentimentos de preocupação, medo e tensão. Embora essa reação seja intrínseca à nossa natureza, ela pode tornar-se prejudicial quando se intensifica de forma excessiva ou persistente, afetando o quotidiano e o funcionamento psicológico do indivíduo. <br>
Por sua vez, o bem-estar emocional diz respeito à capacidade de gerir as emoções, enfrentar desafios e manter um equilíbrio psicológico estável, o conceito envolve a satisfação com a vida, a resiliência frente às adversidades e o sentimento de controlo sobre os próprios pensamentos e emoções. Um elevado nível de bem-estar emocional está frequentemente associado a uma melhor qualidade de vida, relações interpessoais enriquecedoras e maior produtividade em diversas esferas da vida. <br>

A interação entre ansiedade e bem-estar emocional revela-se complexa e multifacetada. Enquanto um determinado grau de ansiedade pode funcionar como um estímulo para a motivação e o desempenho, a sua presença crónica e elevada tende a comprometer o equilíbrio emocional, prejudicando a saúde mental do indivíduo. Diversos fatores, como o ambiente familiar, o contexto social, o nível de stress e os hábitos de vida, exercem uma influência significativa na regulação da ansiedade e na promoção do bem-estar. <br>

Observa-se que, nos últimos anos, o fenômeno da ansiedade tem recebido atenção crescente, sobretudo entre os jovens. Questões como o uso intensivo das redes sociais, a pressão no âmbito académico e profissional, bem como a instabilidade socioeconómica, são apontadas como contribuintes para o aumento dos níveis de ansiedade na sociedade contemporânea. <br>
Nesse sentido, a promoção do bem-estar emocional passa pela implementação de estratégias eficazes de gestão do stress. A prática regular de exercício físico, a adoção de hábitos de vida saudáveis, o fortalecimento das redes de apoio e o desenvolvimento de competências emocionais são fundamentais para a melhoria da saúde mental. Além disso, a conscientização acerca da importância do cuidado com a saúde psicológica, aliada à disponibilização de recursos de apoio, reveste-se de caráter indispensável para auxiliar os indivíduos a lidar com a ansiedade e, assim, alcançar uma vida mais plena e equilibrada.</p>

<br>

<h3>**1. TRATAMENTO DE DADOS**</h3>

<br>

<p>O tratamento dos valores omissos iniciou-se com a substituição dos espaços em branco pelo valor 99. No entanto, para aplicar uma abordagem mais adequada, esses valores foram temporariamente convertidos para null e, em seguida, substituídos pela mediana. Esse método foi utilizado para as variáveis relacionadas com a ansiedade, como "v38_ansiedade", "v40_ansiedade", "v43_ansiedade", "v45_ansiedade", "v51_ansiedade", "v55_ansiedade" e "v56_ansiedade", que apresentavam um número significativo de valores ausentes. A substituição pela mediana permitiu minimizar distorções nos dados e garantir uma representação mais fiel da distribuição original das respostas.</p>


<br> <br>

<h3>**2. ENQUADRAMENTO SOCIAL-DEMOGRÁFICO**</h3>

<br>
<p>De modo a pudermos ter um conhecimento mais aprofundado dos dados disponibilizados pelos 1125 inquiridos, foi feito um enquadramento social-demográfico. Para tal, foram feitos estudos em relação ao género, idade e ciclo escolar.</p>

<p>Em termos de distribuição por género: 255 das pessoas inquiridas identificaram-se como mulheres, sendo então 50% da amostra e 170 identificaram-se como homens, correspondendo a 40% da amostra. (Tabela 1).</p>

```{r, include=FALSE, echo=FALSE}
Gen <- c(unique(bd$Género))
freq_absoluta <- table(bd$Género)

# Calcular a frequência relativa (percentagem)
freq_relativa <- round(prop.table(freq_absoluta)*100) 

# Criar a tabela como um data frame
tabela_frequencias <- data.frame(Género = names(freq_absoluta),
                                 Frequência = as.vector(freq_absoluta),
                                 Percentagem = as.vector(freq_relativa))
ftab_sexo <- flextable(head(tabela_frequencias))
ftab_sexo <- bg(ftab_sexo, bg = "#3895D3", part = "header")
ftab_sexo <- color(ftab_sexo, color = "white", part = "header")
```


<div>

```{r echo=FALSE}
ftab_sexo
```

<p>

<center>**Tabela 1** - Distribuição por género</center>

</p>

<br> <br> <br>

<p>Em termos de distribuição por local de residência dos inquiridos: 141
indivíduos residem na periferia das grandes cidades de Lisboa ou de
Setúbal, representando 33,2% da amostra, enquanto que apenas 1,2%
residem numa casa isolada no campo. Esta análise é relevante ao estudo
uma vez que, dependendo do local de residência do sinquiridos, os
comportamentos e atitudes relativas ao ambiente variam (**Tabela
2**).</p>

<br>

</div>

Histograma de frequências absolutas

```{r, include=TRUE, echo=FALSE}
valores <- as.numeric(bd$satisfacao_vida)
h <- hist(valores,
          main = "Distribuição de Satisfação com a Vida", 
          xlab = "Satisfação com a Vida", 
          ylab = "Frequência", 
          col = "lightblue", 
          )

```

```{r}
valores <- as.numeric(bd$P3)
h <- hist(valores,
          main = "Distribuição das Idades", 
          xlab = "Idades", 
          ylab = "Frequência", 
          col = "lightgreen", 
          )
```
```{r}
Age<-table(bd$P3)

## 2. Tabela com os dados descritivos

N <- round(nrow(bd))
Média <- round(mean(Age, na.rm = TRUE))
Mediana <- round(median(Age, na.rm = TRUE))
DesPad <-round(sd(Age, na.rm = TRUE))
Vari <- round(var(Age, na.rm = TRUE))
Min <- round(min(Age, na.rm = TRUE))
Max <- round(max(Age, na.rm = TRUE))
Q1 <- round(quantile(Age, 0.25, na.rm = TRUE))
Q3 <- round(quantile(Age, 0.75, na.rm = TRUE))

Estatisticas_Descritivas <- c("N", "Média", "Mediana", "Desv. Pad.", "Vari.", "Min", "Max", "1º Q", "3º Q")
Valores_Idades <- c(N, Média, Mediana, DesPad, Vari, Min, Max, Q1, Q3)
Tabela <- data.frame(Estatisticas_Descritivas, Valores_Idades)

ftab_obj <- flextable(Tabela)
ftab_obj <- bg(ftab_obj, bg = "#3895D3", part = "header")
ftab_obj <- color(ftab_obj, color = "white", part = "header")

ftab_obj
```


```{r}
# Definir os 7 títulos (ou sintomas)
specie <- c(
  rep("A", 4),  # 4 repetições para o título "A"
  rep("B", 4),  # 4 repetições para o título "B"
  rep("C", 4),  # 4 repetições para o título "C"
  rep("D", 4),  # 4 repetições para o título "D"
  rep("E", 4),  # 4 repetições para o título "E"
  rep("F", 4),  # 4 repetições para o título "F"
  rep("G", 4)   # 4 repetições para o título "G"
)

# Verificar o comprimento de 'specie'
length(specie)  # Deve retornar 28 (7 títulos * 4 géneros)

# Verifique se bd$P3 existe e não está vazio
if (exists("bd") && !is.null(bd$P3)) {
  # Replicar 'bd$P3' para corresponder ao comprimento de 'specie' (4 géneros por título)
  condition <- rep(bd$P3, length.out = length(specie))
} else {
  stop("bd$P3 não está disponível ou está vazio.")
}

# Calcular as médias das colunas de ansiedade
mean_values <- c(
  mean(bd$v38_ansiedade, na.rm = TRUE),
  mean(bd$v40_ansiedade, na.rm = TRUE),
  mean(bd$v43_ansiedade, na.rm = TRUE),
  mean(bd$v45_ansiedade, na.rm = TRUE),
  mean(bd$v51_ansiedade, na.rm = TRUE),
  mean(bd$v55_ansiedade, na.rm = TRUE),
  mean(bd$v56_ansiedade, na.rm = TRUE)
)

# Replicar as médias para corresponder ao comprimento de 'specie'
value <- rep(mean_values, length.out = length(specie))

# Criar o dataframe
data <- data.frame(specie, condition, value)

# Verifique a estrutura dos dados
str(data)

# Criar o gráfico de barras agrupadas
ggplot(data, aes(fill = condition, y = value, x = specie)) + 
  geom_bar(stat = "identity", position = "dodge") +  # Usar barras agrupadas
  labs(
    title = "Níveis de Ansiedade por Idade",
    x = "Sintomas",
    y = "Média de Ansiedade"
  ) +
  theme_minimal()  # Um tema mais simples


```


```{r, include=TRUE, echo=FALSE}
#boxplot
boxplot(valores, 
        main = "Boxplot da Satisfação com a Vida", 
        ylab = "Satisfação com a Vida", 
        col = "lightgreen")
```

uni

```{r, include=TRUE, echo=FALSE}

# Definir os 7 títulos (ou sintomas)
specie <- c(
  rep("A", 4),  # 4 repetições para o título "A"
  rep("B", 4),  # 4 repetições para o título "B"
  rep("C", 4),  # 4 repetições para o título "C"
  rep("D", 4),  # 4 repetições para o título "D"
  rep("E", 4),  # 4 repetições para o título "E"
  rep("F", 4),  # 4 repetições para o título "F"
  rep("G", 4)   # 4 repetições para o título "G"
)

# Verificar o comprimento de 'specie'
length(specie)  # Deve retornar 28 (7 títulos * 4 géneros)

# Replicar 'bd$Género' para corresponder ao comprimento de 'specie' (4 géneros por título)
condition <- rep(bd$Género, length.out = length(specie))
mean_values <- c(mean(bd$v38_ansiedade),mean(bd$v40_ansiedade),
                 mean(bd$v43_ansiedade),mean(bd$v45_ansiedade),
                 mean(bd$v51_ansiedade),mean(bd$v55_ansiedade),
                 mean(bd$v56_ansiedade)
                 )
# Replicar as médias para corresponder ao comprimento de 'specie'
value <- rep(mean_values, length.out = length(specie))

# Criar o dataframe
data <- data.frame(specie, condition, value)

# Criar o gráfico de barras agrupadas
ggplot(data, aes(fill = condition, y = value, x = specie)) + 
  geom_bar(position = "dodge", stat = "identity") +
  labs(
    title = "Níveis de Ansiedade por Gênero",
    x = "Sintomas",
    y = "Média de Ansiedade"
  ) 

```
